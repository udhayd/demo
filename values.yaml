# Default values for ukgbsfileupload.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

replicaCount: 1

image:
  repository: minio/mc
  pullPolicy: IfNotPresent
  tag: "latest"

nameOverride: ""
fullnameOverride: ""

podAnnotations: {}

podSecurityContext: {}
  # fsGroup: 2000

securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

resources: {}
  # We usually recommend not to specify default resources and to leave this as a conscious
  # choice for the user. This also increases chances charts run on environments with little
  # resources, such as Minikube. If you do want to specify resources, uncomment the following
  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

env:
  # Envirnoment Variables used for pod deployment.
  - name: accesskey
    valueFrom:
      secretKeyRef:
        name: minio1-secret
        key: accesskey
  - name: secretkey
    valueFrom:
      secretKeyRef:
        name: minio1-secret
        key: secretkey
  - name: MC_HOST_stg
    value: https://$(accesskey):$(secretkey)@minio.minio-server

secrets:
  # base64 Encoded secrets for minio access.
  accesskey: dGVzdA==
  secretkey: dGVzdC0xMjMj

hostkey:
  # base64 Encoded secrets for sftp file download.
  ssh_host_key: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFb3dJQkFBS0NBUUVBcTg1U1Jnanp2S1ZYSythNnN2dTF6SkZ1OHoxQkUvNmw2THhuQ1NqcFFBNmtnR2N6CjBFNTcvcS9aVkVKczc0Q29LVE81OTVFQnZLVnI2TXovUTg5VG95bFBCNnh6R3dLQVVOQWo2b0dLblNzRTdMLzcKWm9heFo2NTZpMDNGMW9ORVk3T2Zka1RUUWRuakFSZ2xuNnBNRmNRZ1RwRlRPL0VUbWRRSnBCb1FsK1lKcm1GZgpjYnBIY2w3ckkwNzM4aENURHpXNnlVblhjbG1GTGw2RHVqT0Fteld2clFCRG1aSmZQQkZxYUNFMDVIYUFHQnp4CjJPQW5zK0loS092WmVxbW96ZTVuNXNUamlVU1E3OU9xU3BXeWNWWGN5dDlyUUNYSm5HNGFxWnNObnNIZ1NjYU8KZ2tjM3ZySGMwbkFrdS9xVWVDbHNyckFNajBCc0pUVGxHYmd6UlFJREFRQUJBb0lCQUdFUnZXSmNoSG05WVRjbwpzYXVXayt6MDdwNzNxT0ZIS3k0SDVKOUVRaVV6SUxaN21NYkUwVUhnMFFYT1VnWXZ4dE1ncXAyNWpDV3R3UDVUCmRKWTNlYVhpSFFqVTRtUU1VYnRYSGpQTTVTaFB1Z1NabzgwVnBQNVRrbUZLbTlETGNjUnpKRkdLS1dJM1hRNnQKT2ZTd0h6VGREdlBWSUJYcDY0MHFSQmczc2RCZjl5dWwzbFh0VzgvbDE0S283OVV6aGNuSkdUSG5OV09TUGN4NQpUb1JKdFRONTV2eFRrQTZxODNPUXhoRE9Sd2loejV5d3ExTkg3RHdHVDlvcklUYnRsY2k2TFJOMkZOalNBcUU3CnRyK1NaeUhyZzdWaWNXN2xPMXljZmpXQ2hDbDgrNkhNNlFFWDNKYXduWENnQmF1QVlZMWRNdnlvQWQvb2xBd1kKeVBJNHNRRUNnWUVBM0Q0Yk5lMGJLT1hJdkluQkk4d1VVR3lxUWtPTHczSm1SOWN1WUJHMGIxSXFLTTdRRjU4bgpsYVVxc2ZVZUJJOERsZE5TQ0x5UEQrRnAyeEtsQlNpem1OQTRNa1A2cWtwcVRvUC9PZVJPd0dHcDBXWkllV1N4Cjh3bzAybFlTVlU1N1FIcVF0WE1JZUNhVWhmQ3FwdmoyaXFXN2xRQkg5djhrcnpqakhmdkU5alVDZ1lFQXg3TU4KbURHYXA2Y1lteDBUc0NlZkdUTDNNVzNSZnlTS09aMjJ2ZTdaTmpJOGJsbTBUYk9acGNsc3g0bXYzYnlSVGxWKwpnQnNhNjdhVGc3bmpvdFRqRmgxTE0ybUYxTStpRVoybHdncVE1ejc0bE9MWXFSMng0VHV4WkVOOVFtVEpyQi9LCjR6ai9iMkMydlVka2ZYMFFENWI2NFJsRmY1QnNXaFNVT1pZOHF0RUNnWUJPSHNGc0dWUSs1M0tTWFpKaWJpcnUKYy96WVVEa3M5RkVQUG1ZMnNWRDlBM25zeTU3SUlpM2FTS0dpU2IyQ0JIQlRIb2ZFalkxNUpvMXpwV05mTnhhdApKMzRuWmpGdFljUGZZYmFRQkVsaXQ4R1NndU5HRzg5NjA2MzNtL3dZd2lPNXRUL0svS2lPWmJEYzZZYStmeVNECi9WRlNBcTJFRVBBa0x0dHdjVE5sMlFLQmdDSjZiSWR4VVFWUEdUVjJzTGFDTUxyV0RNMnc2ekdyYWw0R044M1YKRmhXQVdPU29nalBFSld2MU9kMjlqT3FZcXZHK1d3ZmRKaW02TFAvYU1VNGt1VXhSSkhHczcxbE51K3FVc0ZDdgpLRk4wa05DTDFlSms2Umc5Q1NTSmJtL3ZITTZsOG82R2didUdGQ2JiMDZMQzIrb0ZKQzJIQW5QQ3lLSkkyVXFVCkFNZHhBb0dCQU53ZGxvS0Mra01YN3F1dm40aUpCR3ZrZ01xdXl4U1Y2aTJvdXpTcVdHQnAwMWlHN3hlbCtjcm8KKzRWeFI0M3haWEhWRjkwSXhqY1ZhMG5DRFBNNmtZNWRxdXVRN3BMaC95Mkx1cEZTeG1oU1Y3SDlpSUFBWTUxMwpRUEd3Snd6OFlKYVVxMjZuR1FMcVZBMlIzMExic3lIZjdNZTkxWjF4S2g2dTRDb2szeUFZCi0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0tLS0tCg==
  ssh_host_keypub: c3NoLXJzYSBBQUFBQjNOemFDMXljMkVBQUFBREFRQUJBQUFCQVFDcnpsSkdDUE84cFZjcjVycXkrN1hNa1c3elBVRVQvcVhvdkdjSktPbEFEcVNBWnpQUVRudityOWxVUW16dmdLZ3BNN24za1FHOHBXdm96UDlEejFPaktVOEhySE1iQW9CUTBDUHFnWXFkS3dUc3YvdG1ockZucm5xTFRjWFdnMFJqczU5MlJOTkIyZU1CR0NXZnFrd1Z4Q0JPa1ZNNzhST1oxQW1rR2hDWDVnbXVZVjl4dWtkeVh1c2pUdmZ5RUpNUE5ickpTZGR5V1lVdVhvTzZNNENiTmErdEFFT1prbDg4RVdwb0lUVGtkb0FZSFBIWTRDZXo0aUVvNjlsNnFhak43bWZteE9PSlJKRHYwNnBLbGJKeFZkekszMnRBSmNtY2JocXBtdzJld2VCSnhvNkNSemUrc2R6U2NDUzcrcFI0S1d5dXNBeVBRR3dsTk9VWnVETkYga2V5bmFtZQo=

cronjob:
  # Cronjob for sftp file download and upload to minio server.
  schedule: "'*/5 * * * *'"
  spec:
    restartPolicy: OnFailure 
    volumes:
    - name: homedir
      secret:
        secretName: sftp-host-keys
        defaultMode: 0600
    - name: store-files
      emptyDir: {}
    initContainers:
    - name: sftp-jobsrv
      image: udhayashankard/alpine-sshclient
      command: ['sh', '-c', "sftp -oStrictHostKeyChecking=no -i /home/user/.ssh/id_rsa test@10.10.1.209:/home/test/data /collect"]
      volumeMounts:
      - mountPath: /home/user/.ssh/id_rsa
        name: homedir
        subPath: ssh_host_key
      - mountPath: /home/user/.ssh/id_rsa.pub
        name: homedir
        subPath: ssh_host_key.pub
      - mountPath: /collect
        name: store-files
    containers:
    - name: minio-file-push
      image: minio/mc
      env:
      - name: accesskey
        valueFrom:
          secretKeyRef:
            name: minio1-secret
            key: accesskey
      - name: secretkey
        valueFrom:
          secretKeyRef:
            name: minio1-secret
            key: secretkey
      - name: MC_HOST_miniostg
        value: https://$(accesskey):$(secretkey)@minio.minio-server
      command: ["/bin/sh", "-c"]
      args:
      - mc cp /collect/* miniostg/test;
      volumeMounts:
      - mountPath: /collect
        name: store-files
